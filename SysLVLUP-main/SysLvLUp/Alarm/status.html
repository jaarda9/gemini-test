<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Status Screen</title>
    <link rel="stylesheet" href="css/status.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
      
    <div class="status-container">
      <div class="status-title">
        <div class="title-content">
          <span>STATUS</span>
        </div>
      </div>
      <div class="level-section">
        <div class="level-info">
          <div class="level-number" id="lvlValue">1</div>
          <div>LEVEL</div>
          <!--<button id="reset-button">Reset</button>-->
        </div>
        <div class="details">
          <p>
            <strong>Name:</strong>
            <span class="detail-text" id="job-text">Fedy</span>
            <input
              type="text"
              class="detail-input"
              id="job-input"
              placeholder="Enter name"
              style="display: none"
            />
          </p>
          <p>
            <strong>PING:</strong>
            <span class="detail-text" id="ping-text">60</span>
            <input
              type="text"
              class="detail-input"
              id="ping-input"
              placeholder="Enter ping"
              style="display: none"
            />
          </p>
          <p>
            <strong>Guild:</strong>
            <span class="detail-text" id="guild-text">Reaper</span>
            <input
              type="text"
              class="detail-input"
              id="guild-input"
              placeholder="Enter guild"
              style="display: none"
            />
          </p>
          <p>
            <strong>Race:</strong>
            <span class="detail-text" id="race-text">Hunter</span>
            <input
              type="text"
              class="detail-input"
              id="race-input"
              placeholder="Enter race"
              style="display: none"
            />
          </p>
          <p>
            <strong>TITLE:</strong>
            <span class="detail-text" id="title-text">None</span>
            <input
              type="text"
              class="detail-input"
              id="title-input"
              placeholder="Enter title"
              style="display: none"
            />
          </p>
          <p>
            <strong>Region:</strong>
            <span class="detail-text" id="region-text">TN</span>
            <input
              type="text"
              class="detail-input"
              id="region-input"
              placeholder="Enter region"
              style="display: none"
            />
          </p>
          <p>
            <strong>Location:</strong>
            <span class="detail-text" id="location-text">Hospital</span>
            <input
              type="text"
              class="detail-input"
              id="location-input"
              placeholder="Enter location"
              style="display: none"
            />
          </p>
          <p>
            <strong>Rank:</strong>
            <span class="detail-textx" id="rank-text">E-Rank</span>
            <input
              type="text"
              class="detail-input"
              id="rank-input"
              placeholder="Enter rank"
              readonly
              style="display: none"
            />
          </p>
        </div>
      </div>

      <div class="mid-section">
        <div class="status-bars">
          <div class="status-bar">
            <span class="emoji"><i class="fa-solid fa-heart"> </i></span>
            <span class="HP">HP&nbsp;</span>
            <div class="bar">
              <div class="fill" id="hp-fill" style="width: 100%"></div>
            </div>
            <span id="HPvalue">100/100</span>
          </div>
          <div class="status-bar">
            <span class="emoji"><i class="fa-solid fa-flask"></i></span>
            <span class="MP">MP&nbsp;</span>
            <div class="bar">
              <div class="fill" id="mp-fill" style="width: 100%"></div>
            </div>
            <span id="MPvalue">100/100</span>
          </div>
          <div class="status-bar">
            <span class="emoji"
              ><i class="fa-solid fa-bolt"></i></span>
            <span class="STM">STM</span>
            <div class="bar">
              <div class="fill" id="stm-fill" style="width: 100%"></div>
            </div>
            <span id="STMvalue">100/100</span>
          </div>
          <div class="status-bar">
            <span class="emoji"><i class="fa-solid fa-star"></i></span>
            <span>EXP</span>
            <div class="bar">
              <div class="fill" id="exp-fill" style="width: 100%"></div>
            </div>
            <span id="XPvalue">0/100</span>
          </div>
        </div>
        <div class="fatigue-section">
          <div class="fatigue-ring">
            <svg class="progress-ring" width="80" height="80">
              <circle
                class="progress-ring__circle"
                id="fatringprogg"
                stroke="#56ccf2"
                stroke-width="8"
                fill="transparent"
                r="34"
                cx="40"
                cy="40"
              />
            </svg>
            <div class="fatigue-label">
              Fatigue: <span class="fatigue-value" id="Fatvalue">0</span>%
            </div>
          </div>
        </div>
      </div>

      <div class="attributes">
        <div>
          <i class="fas fa-dumbbell stat-icon"></i>
          <span id="str">STR: 10</span>
        </div>
        <div>
          <i class="fas fa-heart stat-icon"></i>
          <span id="vit">VIT: 10</span>
        </div>
        <div>
          <i class="fas fa-running stat-icon"></i>
          <span id="agi">AGI: 10</span>
        </div>
        <div>
          <i class="fas fa-brain stat-icon"></i>
          <span id="int">INT: 10</span>
        </div>
        <div>
          <i class="fas fa-eye stat-icon"></i>
          <span id="per">PER: 10</span>
        </div>
        <div>
          <i class="fa-solid fa-yin-yang stat-icon"></i>
          <span id="wis">WIS: 10</span>
        </div>
      </div>

              <div class="quests">
          <h2>[Active Quests]</h2>
          <div class="quest">
            <span>Grunt Work</span> <span class="status_done">Done</span>
          </div>
          <div class="quest" id="goToDailyQuests">
            <span>[MAIN] Power</span>
            <a href="daily_quest.html" class="status" id="status"
              >Lv.1</a
            >
          </div>
          <div class="quest">
            <span>[SIDE] New World</span> <span class="status_danger">Lv.5</span>
          </div>
           <div class="quest-actions">
              <button class="gemini-button" id="generate-quest-btn">Generate New Quest âœ¨</button>
            </div>
            <div class="quest">
              <span>[SKILLS] Skill Tree</span>
              <a href="skill-tree.html" class="status skill-link">ðŸŒ³</a>
            </div>
            
            <!-- Random Quest Trigger Button -->
            <div class="quest-actions" style="margin-top: 15px;">
              <button class="gemini-button" onclick="randomQuestSystem.triggerQuest()">ðŸŽ¯ Trigger Random Quest</button>
            </div>
            
            <!-- Active Random Quests Display -->
            <div id="active-random-quests" class="active-quests" style="display: none;">
              <h3>ðŸŽ¯ Active Random Quests</h3>
              <div id="random-quests-list">
                <!-- Random quests will be populated here -->
              </div>
            </div>
          <div id="gemini-status"></div>
          <div id="generated-quest" style="display:none; margin-top: 20px;">
            <div class="quest-item">
                <span id="new-quest-title"></span>
                <button id="tts-btn" class="gemini-button" style="padding: 5px 10px; font-size: 0.8em;"><i class="fas fa-volume-up"></i></button>
            </div>
            <p id="new-quest-description" style="margin-top: 10px; font-size: 0.9em;"></p>
          </div>
        <div class="quest">
          <span>[MAIN] Learning Pathways</span>
<span class="status dental-emoji">
    <a href="dental-study.html" class="status-link">ðŸ“–</a>
</span>
        </div>
     
<!-- Name Input Popup -->
<div id="name-popup" class="popup hidden">
  <div class="popup-content">
    <h2>Reveal Your Name ðŸ“œ</h2>
    <input type="text" id="name-input" placeholder="Speak your name, and the path shall be unveiled" />
    <button id="submit-name">Submit</button>
  </div>
</div>
    <script src="js/status.js"></script>

    <script src="js/random-quest.js"></script>

    <link rel="stylesheet" href="css/random-quest.css">
    <script>
// Auto-sync when page loads
// This will sync all localStorage data to your MongoDB
  async function loadDataFromMongoDB() {
 
    const apiUrl = `https://sys-lvlup.vercel.app/api/sync`;

    try {
        const response = await fetch(apiUrl, { method: 'GET' });

        if (response.status === 404) {
            console.log("Device data not found. Starting fresh.");
            return;
        }

        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }

        const data = await response.json();
       
       
        const localStorageData = data.localStorageData;
        
        // Set the fetched data into the browser's localStora
        localStorage.setItem("gameData", JSON.stringify(localStorageData));
        console.log('Data loaded successfully.');

    } catch (error) {
        console.error('Error fetching data:', error);
    }
}



// Example: Call the functions when the page loads
document.addEventListener('DOMContentLoaded', () => {
    loadDataFromMongoDB();
    // You might also want to call saveDataToMongoDB() on a timer or when the user closes the page
    // window.addEventListener('beforeunload', saveDataToMongoDB);
});
</script>

  </body>
</html>
